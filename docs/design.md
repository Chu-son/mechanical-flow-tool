# 設計書

## 要件定義

### アプリケーションの目的
このアプリケーションは、プロジェクト管理やフローチャート作成を支援するためのツールです。ユーザーは以下の機能を利用できます：
- プロジェクトの一覧表示と詳細管理
- デバイスリストの表示
- フローチャートエディタを使用したタスクの視覚的設計

### 主要機能
1. **プロジェクト管理**:
   - プロジェクトの作成、編集、削除
   - プロジェクト詳細の表示
2. **デバイスリスト**:
   - デバイス情報の一覧表示
3. **フローチャートエディタ**:
   - ノードとエッジの作成
   - ドラッグ＆ドロップによるノード配置
   - タスクの総時間計算

---

## 設計概要

### Electron メインプロセス
- **エントリーポイント**: `src/main/main.ts`
- **機能**:
  - ウィンドウ管理 (`BrowserWindow`)：アプリケーションのメインウィンドウを作成。
  - IPC 通信 (`ipcMain`)：レンダラープロセスとのデータ交換。
  - 自動更新 (`electron-updater`)：アプリケーションの更新を管理。

### レンダラープロセス
- **エントリーポイント**: `src/renderer/App.tsx`
- **構成**:
  - React を使用した SPA（シングルページアプリケーション）。
  - ページとコンポーネントの分離。
  - 主要ページ：
    - `/`: プロジェクト一覧ページ (`Projects.tsx`)
    - `/devices`: デバイスリストページ (`Devices.tsx`)
    - `/projects/:projectId`: プロジェクト詳細ページ (`ProjectDetail.tsx`)
    - `/unit/:unitId`: ユニット詳細ページ (`UnitDetail.tsx`)
    - `/flowchart`: フローチャートエディタ (`Flowchart.tsx`)

### フローチャート機能
- **主要コンポーネント**:
  - `TaskNode`: タスクノードの管理と表示。
  - `FlowchartSidebar`: フローチャートの補助操作。
  - `DnDContext`: ドラッグ＆ドロップの状態管理。
- **機能**:
  - ノードの作成、接続、削除。
  - ノード間のデータ伝播（例: 総時間計算）。
  - ドラッグ＆ドロップによるノードの追加。

---

## クラス・コンポーネント構成

### メインプロセス
- **`main.ts`**:
  - アプリケーションのエントリーポイント。
  - ウィンドウとメニューの初期化。
  - IPC 通信の設定。

### レンダラープロセス
- **`App.tsx`**:
  - ルーティングと全体レイアウトの管理。
- **`Sidebar.tsx`**:
  - ナビゲーションメニュー。
- **`Flowchart.tsx`**:
  - フローチャートエディタのメインロジック。
- **`TaskNode.tsx`**:
  - タスクノードのデータ管理と表示。

---

## 技術スタック
- **Electron**: デスクトップアプリケーションのフレームワーク。
- **React**: UI ライブラリ。
- **React Flow**: フローチャート作成ライブラリ。
- **TypeScript**: 型安全なプログラミング言語。

---

## 今後の改善点
1. **コードのモジュール化**:
   - コンポーネント間の依存関係を減らし、再利用性を向上。
2. **ユーザー体験の向上**:
   - フローチャートエディタの操作性を改善。
   - エラーメッセージやガイドの追加。
3. **パフォーマンス最適化**:
   - レンダリングの効率化。
   - 不要な再レンダリングの削減。
